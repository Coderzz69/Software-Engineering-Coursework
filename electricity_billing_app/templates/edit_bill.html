{% extends 'base.html' %}

{% block header %}
Edit Bill
{% endblock %}

{% block content %}
<div class="card" style="max-width: 600px; margin: 0 auto;">
    <h2><i class="fa-solid fa-pen-to-square"></i> Edit Bill Details</h2>

    <form action="{{ url_for('edit_bill', bill_id=bill._id) }}" method="POST" class="bill-form">
        <div class="form-group">
            <label for="household_id">Select Household</label>
            <select id="household_id" name="household_id" required
                style="width: 100%; padding: 12px; background: rgba(15, 23, 42, 0.5); border: 1px solid var(--border-color); border-radius: 10px; color: var(--text-color);">
                <option value="" disabled>Choose a household...</option>
                {% for household in households %}
                <option value="{{ household._id }}" {{ 'selected' if household._id|string==bill.household_id|string
                    else '' }}>
                    {{ household.household_name }} ({{ household.house_number }})
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="units">Units Consumed (kWh)</label>
            <input type="number" id="units" name="units" step="0.01" value="{{ bill.units }}" required>
        </div>

        <div class="form-group">
            <p style="font-size: 0.9rem; color: var(--text-muted);"><i class="fa-solid fa-info-circle"></i> Bill
                calculated based on TSSPDCL Domestic Tariff.</p>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
            <button type="submit" class="btn-primary">Update Bill</button>
            <a href="{{ url_for('history') }}" class="btn-secondary"
                style="text-align: center; text-decoration: none; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.1); color: white; border-radius: 10px; padding: 14px; flex: 1; font-weight: 600;">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const element = document.getElementById('household_id');
        if (element) {
            const choices = new Choices(element, {
                searchEnabled: true,
                itemSelectText: '',
                placeholder: true,
                placeholderValue: 'Choose a household...',
                shouldSort: false,
            });
        }
    });
</script>